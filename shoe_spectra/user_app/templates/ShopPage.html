{% extends 'userBase.html' %}


{% block links %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">




{% endblock %}






{% block css %}

<style>
    .main-nav-list.active a {
        /* font-weight: bold; */
        color: #FFC107;
        /* Bootstrap primary color */
        text-decoration: underline;
    }
</style>


{% endblock %}

{% block content %}

<!-- <div class="container">
    <div class="row">
        <div class="col-xl-3 col-lg-4 col-md-5">
                <form action="" id="filtersForm">
                <div class="sidebar-categories">
                    <div class="head">Browse Categories</div>
                    <ul class="main-categories">
                        {% for c in category %}
                        <li class="main-nav-list"><a data-toggle="collapse" href="#fruitsVegetable"
                                aria-expanded="false" aria-controls="fruitsVegetable"><span
                                    class="lnr lnr-arrow-right"></span>{{c.name}}<span class="number"></span></a>

                        </li>
                        {% endfor %}


                    </ul>
                </div>
                <div class="sidebar-filter mt-50">
                    <div class="top-filter-head">Product Filters</div>
                    <div class="common-filter">
                        <div class="head">Brands</div>
                        <ul>
                           
                           
                            <select id="brandFilter" name="brand_id">
                                <option value="">Select Brand</option>
                                {% for b in brand %}
                                <option value="{{ b.id }}">{{ b.name }}</option>
                                {% endfor %}
                            </select>
                            <h3 ><</h3>
                        </ul>
                    </div>
                    <div class="common-filter">
                        <div class="head">Color</div>
                        
                            <ul>
                                {% for c in color %}
                                <li class="filter-list"><input class="pixel-radio" type="radio" id="black"
                                        name="color"><label for="black">{{c.name}}</label></li>
                                {% endfor %}


                            </ul>
                        </form>
                    </div>
                    
                </div>
        </form>
    </div>
    <div class="col-xl-9 col-lg-8 col-md-7">
        <div class="filter-bar d-flex flex-wrap align-items-center">
            <div class="sorting">
                <select style="display: none;">
                    <option value="1">Default sorting</option>
                    <option value="1">Default sorting</option>
                    <option value="1">Default sorting</option>
                </select>
                <div class="nice-select" tabindex="0"><span class="current">Default sorting</span>
                    <ul class="list">
                        <li data-value="1" class="option selected">Default sorting</li>
                        <li data-value="1" class="option">Default sorting</li>
                        <li data-value="1" class="option">Default sorting</li>
                    </ul>
                </div>
            </div>
            <div class="sorting mr-auto">
                <select style="display: none;">
                    <option value="1">Show 12</option>
                    <option value="1">Show 12</option>
                    <option value="1">Show 12</option>
                </select>
                <div class="nice-select" tabindex="0"><span class="current">Show 12</span>
                    <ul class="list">
                        <li data-value="1" class="option selected">Show 12</li>
                        <li data-value="1" class="option">Show 12</li>
                        <li data-value="1" class="option">Show 12</li>
                    </ul>
                </div>
            </div>
            <div class="pagination">
                <a href="#" class="prev-arrow"><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
                <a href="#" class="active">1</a>
                <a href="#">2</a>
                <a href="#">3</a>
                <a href="#" class="dot-dot"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></a>
                <a href="#">6</a>
                <a href="#" class="next-arrow"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
            </div>
        </div>
        <section class="lattest-product-area pb-40 category-list">
            <div class="row">
                
                {% for p in product %}
                <div class="col-lg-4 col-md-6">
                    <div class="single-product">
                        <img class="img-fluid" src="{{p.image.url}}" alt="">
                        <div class="product-details">
                            <h6>{{p.name}}</h6>
                            <div class="price">
                                <h6>{{p.price}}</h6>
                                <h6 class="l-through">$210.00</h6>
                            </div>
                            <div class="prd-bottom">

                                <a href="" class="social-info">
                                    <span class="ti-bag"></span>
                                    <p class="hover-text">add to bag</p>
                                </a>
                                {% if p.id in user_wishlist %}
                                <a href="{% url 'add-wishList' p.id %}" class="social-info">
                                    <span class="fas fa-heart" style="color: rgb(245, 222, 11);"></span>
                                    <p class="hover-text">In Wishlist</p>
                                </a>
                                {% else %}
                                <a href="{% url 'add-wishList' p.id %}" class="social-info">
                                    <span class="lnr lnr-heart" style="color: rgb(240, 240, 240);"></span>
                                    <p class="hover-text">Wishlist</p>
                                </a>
                                {% endif %}

                               
                                <a href="{% url 'single-page' p.id %}" class="social-info">
                                    <span class="lnr lnr-move"></span>
                                    <p class="hover-text">view more</p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
        <div class="filter-bar d-flex flex-wrap align-items-center">
            <div class="sorting mr-auto">
                <select style="display: none;">
                    <option value="1">Show 12</option>
                    <option value="1">Show 12</option>
                    <option value="1">Show 12</option>
                </select>
                <div class="nice-select" tabindex="0"><span class="current">Show 12</span>
                    <ul class="list">
                        <li data-value="1" class="option selected">Show 12</li>
                        <li data-value="1" class="option">Show 12</li>
                        <li data-value="1" class="option">Show 12</li>
                    </ul>
                </div>
            </div>
            <div class="pagination">
                <a href="#" class="prev-arrow"><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
                <a href="#" class="active">1</a>
                <a href="#">2</a>
                <a href="#">3</a>
                <a href="#" class="dot-dot"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></a>
                <a href="#">6</a>
                <a href="#" class="next-arrow"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
            </div>
        </div>

        
    </div>
</div> -->

<div class="container">
    <div class="row">
        <div class="col-xl-3 col-lg-4 col-md-5">
            <form action="{% url 'shopping-page' %}" method="get" id="filtersForm">
                <div class="sidebar-categories">
                    <div class="head">Browse Categories</div>
                    <ul class="main-categories">
                        {% for c in category %}
                        <li
                            class="main-nav-list {% if request.GET.category == c.id|stringformat:'s' %}active{% endif %}">
                            <a href="{% url 'shopping-page' %}?category={{ c.id }}" aria-expanded="false"
                                aria-controls="fruitsVegetable">
                                <span class="lnr lnr-arrow-right"></span>{{ c.name }}
                                <span class="number"></span>
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="sidebar-categories">
                    <!-- <div class="top-filter-head">Product Filters</div> -->
                    <div class="common-filter">
                        <div class="head">Brands</div>
                        <ul class="main-categories">
                            {% for b in brand %}
                            <li
                                class="main-nav-list {% if request.GET.brand == b.id|stringformat:'s' %}active{% endif %}">
                                <a
                                    href="?brand={{ b.id }}{% if request.GET.color %}&color={{ request.GET.color }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">
                                    {{ b.name }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="common-filter">
                        <div class="head">Color</div>
                        <ul class="main-categories">
                            {% for c in color %}
                            <li
                                class="main-nav-list {% if request.GET.color == c.id|stringformat:'s' %}active{% endif %}">
                                <a
                                    href="?color={{ c.id }}{% if request.GET.brand %}&brand={{ request.GET.brand }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">
                                    {{ c.name }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="common-filter">
                        <div class="head">Price Range</div>
                        <form id="priceFilterForm" method="GET" action="{% url 'shopping-page' %}">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="minPrice">Min Price:</label>
                                        <input type="number" id="minPrice" name="min_price" class="form-control"
                                            placeholder="0" min="0" value="{{ request.GET.min_price|default:'' }}">
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-group">
                                        <label for="maxPrice">Max Price:</label>
                                        <input type="number" id="maxPrice" name="max_price" class="form-control"
                                            placeholder="1000" min="0" value="{{ request.GET.max_price|default:'' }}">
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Apply</button>
                        </form>
                    </div>

                </div>
            </form>
        </div>
        <div class="col-xl-9 col-lg-8 col-md-7">
            <!-- Start Filter Bar -->
            <div class="filter-bar d-flex flex-wrap align-items-center">
                <div class="sorting">

                    {% if request.GET.brand or request.GET.color or request.GET.category or request.GET.min_price or request.GET.max_price %}
                        <button type="button" class="btn btn-primary" onclick="clearFilters();">Refresh</button>
                    {% endif %}

                </div>
                <div class="sorting mr-auto">
                    <form method="GET" action="{% url 'shopping-page' %}" class="form-inline mt-2">
                        <div class="form-group mb-2">
                            <label for="search" class="sr-only">Search</label>
                            <input type="text" class="form-control" name="q" id="search" placeholder="Search products..." value="{{ request.GET.q }}">
                        </div>
                        <button type="submit" class="btn btn-primary mb-2 ml-2">Search</button>
                    </form>
                </div>
                <div class="pagination">
                    <a href="#" class="prev-arrow"><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
                    <a href="#" class="active">1</a>
                    <a href="#">2</a>
                    <a href="#">3</a>
                    <a href="#" class="dot-dot"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></a>
                    <a href="#">6</a>
                    <a href="#" class="next-arrow"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
                </div>
            </div>
            <!-- End Filter Bar -->
            <!-- Start Best Seller -->
            <section class="lattest-product-area pb-40 category-list">
                {% if no_items_message %}
                <div class="alert alert-info mt-5" role="alert">
                    {{ no_items_message }}
                </div>
                {% endif %}
                <div class="row">

                    <!-- single product -->
                    {% for p in product %}
                    <div class="col-lg-4 col-md-6">
                        <div class="single-product">
                            <img class="img-fluid" src="{{ p.image.url }}" alt="">
                            <div class="product-details">
                                <h6>{{ p.name }}</h6>
                                <div class="price">
                                    <!-- <h6>{{ p.price }}</h6>
                                    <h6 class="l-through">$210.00</h6> -->

                                    {% if p.discounted_price %}
                                    <h6>${{ p.discounted_price }}</h6>
                                    <h6 class="l-through">${{ p.price }}</h6> <!-- Original price strikethrough -->
                                {% else %}
                                    <h6>${{ p.price }}</h6>
                                {% endif %}
                                </div>
                                <div class="prd-bottom">
                                    <a href="#" class="social-info">
                                        <span class="ti-bag"></span>
                                        <p class="hover-text">add to bag</p>
                                    </a>
                                    {% if p.id in user_wishlist %}
                                    <a href="{% url 'add-wishList' p.id %}" class="social-info">
                                        <span class="fas fa-heart" style="color: rgb(245, 222, 11);"></span>
                                        <p class="hover-text">In Wishlist</p>
                                    </a>
                                    {% else %}
                                    <a href="{% url 'add-wishList' p.id %}" class="social-info">
                                        <span class="lnr lnr-heart" style="color: rgb(240, 240, 240);"></span>
                                        <p class="hover-text">Wishlist</p>
                                    </a>
                                    {% endif %}
                                    <a href="{% url 'single-page' p.id %}" class="social-info">
                                        <span class="lnr lnr-move"></span>
                                        <p class="hover-text">view more</p>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </section>
            <!-- End Best Seller -->
        </div>
    </div>
</div>


{% endblock %}


{% block js %}

<script>
    // $(document).ready(function () {
    //     $('#filtersForm select').on('change', function () {
    //         $.ajax({
    //             url: "{% url 'shopping-page' %}",  // Adjust the URL to match your route name
    //             method: "POST",
    //             data: {
    //                 category_id: $('#categoryFilter').val(),
    //                 color_id: $('#colorFilter').val(),
    //                 price_range: $('#priceFilter').val(),
    //                 csrfmiddlewaretoken: '{{ csrf_token }}'
    //             },
    //             success: function(response) {
    //         $('#product-list-container').html(response.products_html);
    //     }
    //         });
    //     });
    // });


    // document.addEventListener('DOMContentLoaded', () => {
    //     // Get form and select elements
    //     const form = document.getElementById('filtersForm');
    //     const brandFilter = document.getElementById('brandFilter');
    //     const colorFilters = document.querySelectorAll('input[name="color"]');

    //     // Function to load products via AJAX
    //     function loadProducts() {
    //         const formData = new FormData(form);

    //         fetch("{% url 'shopping-page' %}", {
    //             method: 'GET',
    //             body: new URLSearchParams(formData).toString(),
    //             headers: {
    //                 'Accept': 'text/html'
    //             }
    //         })
    //             .then(response => response.text())
    //             .then(data => {
    //                 document.getElementById('product-list').innerHTML = data;
    //             })
    //             .catch(error => console.error('Error:', error));
    //     }

    //     // Add event listener for brand filter change
    //     brandFilter.addEventListener('change', () => {
    //         loadProducts();
    //     });

    //     // Add event listeners for color filter changes
    //     colorFilters.forEach(colorFilter => {
    //         colorFilter.addEventListener('change', () => {
    //             loadProducts();
    //         });
    //     });

    //     // Add event listener for category filter clicks
    //     document.querySelectorAll('.filter-link').forEach(link => {
    //         link.addEventListener('click', (e) => {
    //             e.preventDefault();
    //             const categoryId = link.dataset.category;
    //             document.querySelector('select[name="category"]').value = categoryId;
    //             loadProducts();
    //         });
    //     });

    //     // Initial load
    //     loadProducts();
    // });

    function clearFilters() {
        // Redirect to the base URL without any query parameters
        window.location.href = window.location.pathname;
    }

</script>

{% endblock %}